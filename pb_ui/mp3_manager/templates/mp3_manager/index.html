{% load static %}
{% load crispy_forms_tags %}
<!DOCTYPE html>
<html>
<head>
    <title>PARTY BUTTON</title>
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    {% load bootstrap5 %}
    {% bootstrap_css %}
    {% bootstrap_javascript %}
</head>
<body>

<div class="container">
    <div class="row">
        <div class="col">
        <h1>Welcome to PARTY BUTTON</h1>
        <h2>Upload Track</h2> 
        {% if form_errors %}
            <div class="alert">{{ form_errors }}</div>
        {% endif %}
            <form id="track_form" name="track_form" action=""{% url 'mp3_manager:index' %}" method="post" enctype="multipart/form-data">
            {% csrf_token %}
            {{ form|crispy }}
            <input type="submit" form="track_form" value="Upload" id="track_upload" name="track_upload"></input>
            </form>
        </div>
    </div>
    <hr />
    <div class="row">
        <div class="col">
           <h2>Set Play Time</h2>
           <form id="playtime_form" id="name_form" action=""{% url 'mp3_manager:index' %}" method="post" enctype="multipart/form-data">
            {% csrf_token %}
            {{ playtimeform|crispy }}
           <input type="submit" form="playtime_form" value="Update" id="playtime_update" name="playtime_update"></input>
           </form>
        </div>
    </div>
    <hr />
    <div class="row">
        <div class="col">
        <h2>Track List</h2>
        {% if tracks_list %}
            <table class="table table-striped table-bordered table-sm" cellspacing="0" width="100%">
                <thead><tr><th></th><th colspan="2">Start Time</th><th colspan="4">Overrides</th><th></th></tr>
                <tr><th>Track Name</th><th>Min</th><th>Sec</th><th>Solo?</th><th>Play Whole Track</th><th>Override global playtime</th><th>Track playtime (seconds)</th></th><th>Remove</th></tr></thead>
                <tbody>
                {% for track in tracks_list %}
                  <tr><td>{{ track.name }}</td>
                      <td>{{ track.minutes }}</td>
                      <td>{{ track.seconds }}</td>
                      <td>
                          {% if track.solo == True %}
                            <a href="{% url 'mp3_manager:solo_track' pk=track.pk %}"><button type="button" class="btn btn-success">Solo</button></a>
                          {% else %}
                            <a href="{% url 'mp3_manager:solo_track' pk=track.pk %}"><button type="button" class="btn btn-primary">Solo</button></a>
                          {% endif %}
                      </td>
                      <td>
                        {% if track.play_full == True %}
                          <a href="{% url 'mp3_manager:play_full' pk=track.pk %}"><button type="button" class="btn btn-success">Using Whole Track</button></a>
                        {% else %}
                          <a href="{% url 'mp3_manager:play_full' pk=track.pk %}"><button type="button" class="btn btn-primary">Using Play Time Settings</button></a>
                        {% endif %}
                      </td>
                      <td>
                        {% if track.override_playtime == True %}
                          <a href="{% url 'mp3_manager:override' pk=track.pk %}"><button type="button" class="btn btn-success">Using Track's Playtime</button></a>
                        {% else %}
                          <a href="{% url 'mp3_manager:override' pk=track.pk %}"><button type="button" class="btn btn-primary">Use Global Play Time</button></a>
                        {% endif %}
                      </td>
                      <td>
                        <form id="trackplaytime_form" id="trackplaytime_update" action=""{% url 'mp3_manager:index' %}" method="post" enctype="multipart/form-data" method="post">
                          {% csrf_token %}
                          <input type="textarea" id="playtime_seconds" name="playtime_seconds" value={{ track.playtime_seconds }}>
                          <input type="hidden" id="pk" name="pk" value="{{ track.pk }}">
                          <input type="submit" form="trackplaytime_form" value="Update" id="trackplaytime_update" name="trackplaytime_update"></input></form>
                      </td>
                      <td><a href="{% url 'mp3_manager:delete_track' pk=track.pk %}"><button type="button" class="btn btn-danger">Delete</button></a></td></tr>
                {% endfor %}
                </tbody>
            </table>
        {% else %}
          <p><h2>No tracks available.</h2></p>
        {% endif %}
        </div>
    </div>
</div>

</body>
</html>
